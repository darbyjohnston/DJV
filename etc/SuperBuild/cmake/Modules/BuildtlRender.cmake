include(ExternalProject)

set(TLRENDER_GIT_REPOSITORY "https://github.com/darbyjohnston/tlRender.git")
set(TLRENDER_GIT_TAG "15a863c02c905276d9a2c8c77f01061d1852e2a6")

set(TLRENDER_DEPS)
set(TLRENDER_ARGS
    -Dfeather_tk_API=${feather_tk_API}
    -DTLRENDER_NET=${TLRENDER_NET}
    -DTLRENDER_OCIO=${TLRENDER_OCIO}
    -DTLRENDER_JPEG=${TLRENDER_JPEG}
    -DTLRENDER_TIFF=${TLRENDER_TIFF}
    -DTLRENDER_STB=${TLRENDER_STB}
    -DTLRENDER_EXR=${TLRENDER_EXR}
    -DTLRENDER_FFMPEG=${TLRENDER_FFMPEG}
    -DTLRENDER_FFMPEG_MINIMAL=${TLRENDER_FFMPEG_MINIMAL}
    -DTLRENDER_USD=${TLRENDER_USD}
    -DTLRENDER_USD_PYTHON=${TLRENDER_USD_PYTHON}
    -DTLRENDER_BMD=${TLRENDER_BMD}
    -DTLRENDER_BMD_SDK=${TLRENDER_BMD_SDK}
    -DTLRENDER_PROGRAMS=OFF
    -DTLRENDER_EXAMPLES=OFF
    -DTLRENDER_TESTS=OFF
    ${DJV_EXTERNAL_ARGS})

ExternalProject_Add(
    tl-sbuild
    PREFIX ${CMAKE_CURRENT_BINARY_DIR}/tl-sbuild
    DEPENDS ${TLRENDER_DEPS}
    GIT_REPOSITORY ${TLRENDER_GIT_REPOSITORY}
    GIT_TAG ${TLRENDER_GIT_TAG}
    INSTALL_COMMAND ""
    SOURCE_SUBDIR etc/SuperBuild
    LIST_SEPARATOR |
    CMAKE_ARGS ${TLRENDER_ARGS})

ExternalProject_Add(
    tlRender
    PREFIX ${CMAKE_CURRENT_BINARY_DIR}/tl
    DEPENDS tl-sbuild
    GIT_REPOSITORY ${TLRENDER_GIT_REPOSITORY}
    GIT_TAG ${TLRENDER_GIT_TAG}
    LIST_SEPARATOR |
    CMAKE_ARGS ${TLRENDER_ARGS})
